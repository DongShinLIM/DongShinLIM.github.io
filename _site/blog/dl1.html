<!doctype html>

<html class="no-js" lang="en">

<head>


	<!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

	Jonathan Lim

	Journal Theme by https://jekyllthemes.io
	Premium + free Jekyll themes for your blog or website.

	- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->


	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

	<!-- Page Info -->
	<link rel="shortcut icon" href="/images/favicon.png">
	<title>Deep Learning – Jonathan Lim</title>
	<meta name="description" content="1-1 A first look at a neural network">

	<!-- Twitter Card -->
	<meta name="twitter:card" content="summary_large_image">
	<meta name="twitter:title" content="Deep Learning – Jonathan Lim">
	<meta name="twitter:description" content="1-1 A first look at a neural network">
	<meta name="twitter:image:src" content="http://localhost:4000/images/demo/dl.jpg">

	<!-- Facebook OpenGraph -->
	<meta property="og:title" content="Deep Learning – Jonathan Lim" />
	<meta property="og:description" content="1-1 A first look at a neural network" />
	<meta property="og:image" content="http://localhost:4000/images/demo/dl.jpg" />

	
	<!-- Font Embed Code -->
	<link href="https://fonts.googleapis.com/css?family=Merriweather:300,400|Muli:400,400i,600" rel="stylesheet">
	

	<!-- Styles -->
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="/css/style.css">
	
	<!-- Icons -->
	<script defer src="https://use.fontawesome.com/releases/v5.1.1/js/solid.js" integrity="sha384-GXi56ipjsBwAe6v5X4xSrVNXGOmpdJYZEEh/0/GqJ3JTHsfDsF8v0YQvZCJYAiGu" crossorigin="anonymous"></script>
	<script defer src="https://use.fontawesome.com/releases/v5.1.1/js/brands.js" integrity="sha384-0inRy4HkP0hJ038ZyfQ4vLl+F4POKbqnaUB6ewmU4dWP0ki8Q27A0VFiVRIpscvL" crossorigin="anonymous"></script>
	<script defer src="https://use.fontawesome.com/releases/v5.1.1/js/fontawesome.js" integrity="sha384-NY6PHjYLP2f+gL3uaVfqUZImmw71ArL9+Roi9o+I4+RBqArA2CfW1sJ1wkABFfPe" crossorigin="anonymous"></script>

	
	<!-- Custom Styles -->
	<style></style>
	

	
	<!-- Analytics Code -->
	
	

	
	<!-- Extra Header JS Code -->
	
	
	
</head>


<body class="loading ajax-loading" data-site-url="http://localhost:4000" data-page-url="/blog/dl1">


	<header class="header">

	<div class="header-image header-image--on" style="background-image: url(/images/demo/dl.jpg);"></div>
	<div class="header-image"></div>

	<div class="header-overlay"></div>

	<div class="header__content">

		
		<a href="/" class="header__title">
			Jonathan Lim
		</a>
		

		<p class="header__tagline">Talent is the desire to practice and that it's attitude that counts</p>

		<div class="menu">
			<div class="menu__toggle js-menu-toggle">
				<div class="menu__toggle__icon"><span></span></div>
			</div>
			<div class="menu__wrap">
				<ul class="menu__list">
					
					<li class="menu__list__item">
						<a href="/about" class="menu__list__item__link">About</a>
					</li>
					
					<li class="menu__list__item">
						<a href="/" class="menu__list__item__link">Latest</a>
					</li>
					
					<li class="menu__list__item">
						<a href="/projects/" class="menu__list__item__link">Projects</a>
					</li>
					
					<li class="menu__list__item">
						<a href="/iotas/" class="menu__list__item__link">IOTA</a>
					</li>
					
					<li class="menu__list__item">
						<a href="/contact" class="menu__list__item__link">Contact</a>
					</li>
					
				</ul>
				<ul class="socials">
	
	
	
	
	<li class="socials__item">
		<a href="https://twitter.com/__JonathanLim__" target="_blank" class="socials__item__link" title="Twitter">
			<i class="fab fa-twitter" aria-hidden="true"></i>
		</a>
	</li>
	
	
	
	<li class="socials__item">
		<a href="https://instagram.com/d_shin91" target="_blank" class="socials__item__link" title="Instagram">
			<i class="fab fa-instagram" aria-hidden="true"></i>
		</a>
	</li>
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	<li class="socials__item">
		<a href="https://github.com/DongShinLIM" target="_blank" class="socials__item__link" title="Github">
			<i class="fab fa-github" aria-hidden="true"></i>
		</a>
	</li>
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
</ul>
			</div>
		</div>

	</div>

</header>


	<div class="loader"><svg width="120" height="30" viewBox="0 0 120 30" xmlns="http://www.w3.org/2000/svg"><circle cx="15" cy="15" r="15"><animate attributeName="r" from="15" to="15" begin="0s" dur="0.8s" values="15;9;15" calcMode="linear" repeatCount="indefinite" /><animate attributeName="fill-opacity" from="1" to="1" begin="0s" dur="0.8s" values="1;.5;1" calcMode="linear" repeatCount="indefinite" /></circle><circle cx="60" cy="15" r="9" fill-opacity="0.3"><animate attributeName="r" from="9" to="9" begin="0s" dur="0.8s" values="9;15;9" calcMode="linear" repeatCount="indefinite" /><animate attributeName="fill-opacity" from="0.5" to="0.5" begin="0s" dur="0.8s" values=".5;1;.5" calcMode="linear" repeatCount="indefinite" /></circle><circle cx="105" cy="15" r="15"><animate attributeName="r" from="15" to="15" begin="0s" dur="0.8s" values="15;9;15" calcMode="linear" repeatCount="indefinite" /><animate attributeName="fill-opacity" from="1" to="1" begin="0s" dur="0.8s" values="1;.5;1" calcMode="linear" repeatCount="indefinite" /></circle></svg></div>

	<div class="page-loader"></div>

	
	<div class="page">

		<div class="page__content" data-page-title="Deep Learning – Jonathan Lim" data-image="/images/demo/dl.jpg">

			<section class="intro">

	<div class="wrap">

		<h1>Deep Learning</h1>
		<p>20 September 2019</p>

	</div>

</section>

<section class="single">

	<div class="wrap">

		<h3 id="mnist-dataset을-기본적인-딥러닝-알고리즘-구현하기">MNIST dataset을 기본적인 딥러닝 알고리즘 구현하기</h3>
<p>MNIST는 머신러닝에서 고전으로 취급 받는 흑백 손글씨 데이터셋이다. 숫자 이미지(28×28픽셀)를 10개의 범주(0부터 9까지)로 분류하는 문제로써
6만개의 훈련 이미지와 1만 개의 테스트 이미지로 구성되어 있다. MNIST 데이터셋은 넘파이 배열 형태로 케라스에 포함되어 있습니다.</p>

<p><img src="/images/demo/mnist.PNG" alt="" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">keras.datasets</span> <span class="kn">import</span> <span class="n">mnist</span>

<span class="p">(</span><span class="n">train_images</span><span class="p">,</span> <span class="n">train_labels</span><span class="p">),</span> <span class="p">(</span><span class="n">test_images</span><span class="p">,</span> <span class="n">test_labels</span><span class="p">)</span> <span class="o">=</span> <span class="n">mnist</span><span class="o">.</span><span class="n">load_data</span><span class="p">()</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Downloading data from https://s3.amazonaws.com/img-datasets/mnist.npz
11493376/11490434 [==============================] - 5s 0us/step
</code></pre></div></div>

<h3 id="train-dataset-test-dataset-validation-dataset">Train dataset, Test dataset, validation dataset</h3>
<p>train_images와 train_labels가 모델이 학습해야 할 훈련 세트를 구성하고 test_images와 test_labels로 구성 된 테스트셋에서 테스트 될 것입니다.
훈련데이터를 살펴보면 다음과 같습니다.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train_images</span><span class="o">.</span><span class="n">shape</span>
</code></pre></div></div>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(60000, 28, 28)
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">len</span><span class="p">(</span><span class="n">train_labels</span><span class="p">)</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>60000
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train_labels</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>array([5, 0, 4, ..., 5, 6, 8], dtype=uint8)
</code></pre></div></div>

<p>테스트 데이터는 다음과 같습니다.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">test_images</span><span class="o">.</span><span class="n">shape</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(10000, 28, 28)
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">len</span><span class="p">(</span><span class="n">test_labels</span><span class="p">)</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10000
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">test_labels</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>array([7, 2, 1, ..., 4, 5, 6], dtype=uint8)
</code></pre></div></div>

<h4 id="작업순서는-다음과-같습니다">작업순서는 다음과 같습니다.</h4>
<ul>
  <li>훈련 데이터 train_images와 train_labels를 네트워크에 주입합니다.</li>
  <li>네트워크는 레이블을 연관시킬 수 있도록 학습됩니다.</li>
  <li>test_images에 대한 예측을 네트워크에 요청합니다.</li>
  <li>예측된 레이블이 test_labels와 맞는지 확인합니다.</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">keras</span> <span class="kn">import</span> <span class="n">models</span>
<span class="kn">from</span> <span class="nn">keras</span> <span class="kn">import</span> <span class="n">layers</span>

<span class="n">network</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Sequential</span><span class="p">()</span>
<span class="n">network</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">512</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s">'relu'</span><span class="p">,</span> <span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">28</span> <span class="o">*</span> <span class="mi">28</span><span class="p">,)))</span>
<span class="n">network</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s">'softmax'</span><span class="p">))</span>
</code></pre></div></div>

<h4 id="architecture-of-deep-neural-networks">Architecture of Deep Neural Networks</h4>
<ul>
  <li>신경망의 핵심 구성요소는 일정의 데이터 처리 필터라고 생각 할 수 있는 층(layer)입니다. 어떠한 데이터가 들어가면 더 유용한 형태로 출력됩니다.</li>
  <li>조금 더 구체적으로 층은 주어진 문제에 더 의미 있는 표현(representation)을 입력 된 데이터로부터 추출합니다.</li>
  <li>대부분의 딥러닝은 간단 한 층을 연결하여 구성되어 있고, 점차 데이터를 정제하는 형태를 가지고 있습니다</li>
</ul>

<p><strong>Example</strong>:</p>
<ul>
  <li>여기서는 완전연결(fully connected)된 신경망 층인 Dense층 2개가 연속되어 있습니다.</li>
  <li>두 번째 층은 10개의 확률 점수가 들어있는 배열을 반환하는 소프트맥스(softmax)층 입니다.</li>
  <li>각 점수는 현재 숫자 이미지가 10개의 숫자 클래스중 하나에 속할 확률 입니다.</li>
</ul>

<h4 id="신경망이-훈련-준비를-마치기-위해서는-컴파일-단계에-포함-될-세가지가-더-필요합니다">신경망이 훈련 준비를 마치기 위해서는 컴파일 단계에 포함 될 세가지가 더 필요합니다.</h4>

<ul>
  <li>손실함수: 예측값과 실제 값의 차이를 계산하는 함수입니다. 훈련 데이터에서 신경망의 성능을 측정하는 방법으로 네트위크가 옳은 방향으로 학습될 수 있도록 도와줍니다.</li>
  <li>옵티마이저: 입련된 데이터와 손실함 수를 기반으로 네트워크 weight를 업데이트 하는 메커니즘입니다.</li>
  <li>훈련과 테스트 과정을 모니터링 할 지표 : 정확도(정확히 분류된 이미지의 비율)만 고려</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">network</span><span class="o">.</span><span class="nb">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s">'rmsprop'</span><span class="p">,</span>
                <span class="n">loss</span><span class="o">=</span><span class="s">'categorical_crossentropy'</span><span class="p">,</span>
                <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s">'accuracy'</span><span class="p">])</span>
</code></pre></div></div>

<h4 id="preprocessiong">Preprocessiong</h4>
<ul>
  <li>훈련을 시작하기 전에 데이터를 네트워크에 맞는 크기로 바꾸고 모든 값을 0과 1사이로 스케일을 조정합니다.
예를 들어 우리의 훈련 이미지는 [0.255]사이의 값인 unit8 타입의 (60000, 28, 28)크기를 가진 배열로 저장되어 있으니 
이 데이터를 0과 1사이의 값을 가지는 float32타입의 (60000, 28×28)크기인 배열로 바꿔줍니다.</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train_images</span> <span class="o">=</span> <span class="n">train_images</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">60000</span><span class="p">,</span> <span class="mi">28</span> <span class="o">*</span> <span class="mi">28</span><span class="p">))</span>
<span class="n">train_images</span> <span class="o">=</span> <span class="n">train_images</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s">'float32'</span><span class="p">)</span> <span class="o">/</span> <span class="mi">255</span>

<span class="n">test_images</span> <span class="o">=</span> <span class="n">test_images</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">10000</span><span class="p">,</span> <span class="mi">28</span> <span class="o">*</span> <span class="mi">28</span><span class="p">))</span>
<span class="n">test_images</span> <span class="o">=</span> <span class="n">test_images</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s">'float32'</span><span class="p">)</span> <span class="o">/</span> <span class="mi">255</span>
</code></pre></div></div>
<p>레이블을 범주형으로 인코딩 해야하는 것도 필요합니다.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">keras.utils</span> <span class="kn">import</span> <span class="n">to_categorical</span>

<span class="n">train_labels</span> <span class="o">=</span> <span class="n">to_categorical</span><span class="p">(</span><span class="n">train_labels</span><span class="p">)</span>
<span class="n">test_labels</span> <span class="o">=</span> <span class="n">to_categorical</span><span class="p">(</span><span class="n">test_labels</span><span class="p">)</span>
</code></pre></div></div>
<p>이제 신경망을 훈련시킬 준비가 되었습니다. 케라스에서 fit 메서드를 호출하여 훈련 데이터에 모델을 학습시킵니다.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">network</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_images</span><span class="p">,</span> <span class="n">train_labels</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">128</span><span class="p">)</span>
</code></pre></div></div>
<ul>
  <li>epochs : 내 뉴럴넷이 전체 데이터를 몇 번 봤는지를 의미합니다.</li>
  <li>batch_size(mini_batch) : 몇 개씩 묶어서 도출 된 loss값을 가지고 weight를 업데이트 하는지 의미합니다.</li>
  <li>iteration : 전체 데이터 / batch_size 이며, 이 예에서는 60,000/128 = 469 를 의미합니다.</li>
</ul>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Epoch 1/5
60000/60000 [==============================] - 1s 22us/step - loss: 0.2540 - accuracy: 0.9266
Epoch 2/5
60000/60000 [==============================] - 1s 20us/step - loss: 0.1016 - accuracy: 0.9700
Epoch 3/5
60000/60000 [==============================] - 1s 19us/step - loss: 0.0678 - accuracy: 0.9803
Epoch 4/5
60000/60000 [==============================] - 1s 19us/step - loss: 0.0496 - accuracy: 0.9852
Epoch 5/5
60000/60000 [==============================] - 1s 19us/step - loss: 0.0375 - accuracy: 0.9886
</code></pre></div></div>

<p>훈련하는 동안 2개의 정확도가 출력됩니다. 훈련 데이터에 대한 네트워크 손실과 정확도입니다.
훈련 데이터에 대하여 98.9%의 정확도를 금방 달성하는 것을 볼 수 있습니다. 이제 테스트 셋에서도 모델이 잘 작동하는지 확인해보겠습니다.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">test_loss</span><span class="p">,</span> <span class="n">test_acc</span> <span class="o">=</span> <span class="n">network</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">test_images</span><span class="p">,</span> <span class="n">test_labels</span><span class="p">)</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10000/10000 [==============================] - 0s 17us/step
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="s">'test_acc:'</span><span class="p">,</span> <span class="n">test_acc</span><span class="p">)</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>test_acc: 0.9803000092506409
</code></pre></div></div>

<p>테스트 셋의 정확도는 98%로 나왔습니다. 훈련 세트 정확도보다 약간 떨어지는 이유는 과적합(overfitting)때문 입니다.</p>



	</div>

</section>

		</div>

	</div>


	<footer class="footer">

	<div class="footer__copyright">
		<span>© 2019 Jonathan Lim</span>
		<a href="https://jekyllthemes.io" target="_blank">Jekyll Themes</a>
	</div>

</footer>


	<!-- Javascript Assets -->
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
	<script src="/js/journal-min.js"></script>

	
	<!-- Extra Footer JS Code -->
	
	


</body>

</html>